{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"45091921-bafbe55c990439d7032dec8c8\";\nconst perPage = 15;\nconst LIM = 20;\n\nexport async function searchGalleryQuery(query, page) {\n    try {\n        const response = await axios.get(URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page,\n                _limit: LIM,\n                per_page: perPage\n            }\n        });\n        return response.data;\n    } catch (error) {\n        console.error(error);\n        throw new Error('Failed to fetch data');\n    }\n\n}","\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport function createImages(data) {\n    const lightbox = new SimpleLightbox('.gallery-list a', {\n        captions: true,\n        captionsData: 'alt',\n        captionsDelay: 250\n    });\n\n    const galleryList = document.querySelector('.gallery-list');\n\n    let images = data.hits.map((image) =>\n        `<div class=\"image-wrapper\">\n    <a href=\"${image.largeImageURL}\">\n    <img class=\"gallery-img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\"></img>\n    </a>\n    <div class=\"text-wrapper\">\n    <div class=\"text-item\"><h5 class=\"text-header\">Likes</h5><p class=\"text-paragraph\">${image.likes}</p></div>\n    <div class=\"text-item\"><h5 class=\"text-header\">Views</h5><p class=\"text-paragraph\">${image.views}</p></div>\n    <div class=\"text-item\"><h5 class=\"text-header\">Comments</h5><p class=\"text-paragraph\">${image.comments}</p></div>\n    <div class=\"text-item\"><h5 class=\"text-header\">Downloads</h5><p class=\"text-paragraph\">${image.downloads}</p></div>\n    </div>\n    </div>`).join(\"\");\n        \n    galleryList.insertAdjacentHTML('beforeend', images);\n    lightbox.refresh();\n}\n\nexport function clearImages() {\n    const galleryList = document.querySelector('.gallery-list');\n    galleryList.innerHTML = \"\";\n}","// main.js\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { searchGalleryQuery } from \"./js/pixabay-api\";\nimport { createImages, clearImages } from \"./js/render-functions\";\n\nconst form = document.querySelector('.form-gallery');\nconst input = document.querySelector('.form-gallery-input');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet searchWord = '';\nlet page = 1;\nlet totalHits = 0;\n\nform.addEventListener('submit', handleSubmitBtn);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nasync function handleSubmitBtn(event) {\n    event.preventDefault();\n    clearImages();\n    loadMoreBtn.classList.add('hidden');\n    loader.classList.remove('hidden');\n\n    searchWord = input.value.trim();\n    page = 1;\n\n    try {\n        const data = await searchGalleryQuery(searchWord, page);\n        if (data.total === 0 || searchWord === \"\") { \n            iziToast.error({\n                position: 'topRight',\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n            });\n        } else {\n            createImages(data);\n            totalHits = data.totalHits;\n            if (data.hits.length > 0) {\n                loadMoreBtn.classList.remove('hidden');\n            }\n        }\n    } catch (error) {\n        iziToast.error({\n            position: 'topRight',\n            message: \"Error fetching images. Please try again later.\",\n        });\n    } finally {\n        loader.classList.add('hidden');\n    }\n\n    form.reset();\n}\n\nasync function handleLoadMore() {\n    page += 1;\n    loader.classList.remove('hidden');\n    loadMoreBtn.classList.add('hidden');\n\n    try {\n        const data = await searchGalleryQuery(searchWord, page);\n        createImages(data);\n\n        if (page * 15 >= totalHits) {\n            loadMoreBtn.classList.add('hidden');\n            iziToast.info({\n                position: 'topRight',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        } else {\n            loadMoreBtn.classList.remove('hidden');\n        }\n\n        // Плавная прокрутка страницы\n        const { height: cardHeight } = document\n            .querySelector('.gallery-list')\n            .firstElementChild.getBoundingClientRect();\n\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth',\n        });\n\n    } catch (error) {\n        iziToast.error({\n            position: 'topRight',\n            message: \"Error loading more images. Please try again later.\",\n        });\n    } finally {\n        loader.classList.add('hidden');\n    }\n}\n"],"names":["URL","API_KEY","perPage","LIM","searchGalleryQuery","query","page","axios","error","createImages","data","lightbox","SimpleLightbox","galleryList","images","image","clearImages","form","input","loader","loadMoreBtn","searchWord","totalHits","handleSubmitBtn","handleLoadMore","event","iziToast","cardHeight"],"mappings":"owBAEA,MAAMA,EAAM,2BACNC,EAAU,qCACVC,EAAU,GACVC,EAAM,GAEL,eAAeC,EAAmBC,EAAOC,EAAM,CAClD,GAAI,CAaA,OAZiB,MAAMC,EAAM,IAAIP,EAAK,CAClC,OAAQ,CACJ,IAAKC,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,OAAQH,EACR,SAAUD,CACb,CACb,CAAS,GACe,IACnB,OAAQM,EAAO,CACZ,cAAQ,MAAMA,CAAK,EACb,IAAI,MAAM,sBAAsB,CACzC,CAEL,CCvBO,SAASC,EAAaC,EAAM,CAC/B,MAAMC,EAAW,IAAIC,EAAe,kBAAmB,CACnD,SAAU,GACV,aAAc,MACd,cAAe,GACvB,CAAK,EAEKC,EAAc,SAAS,cAAc,eAAe,EAE1D,IAAIC,EAASJ,EAAK,KAAK,IAAKK,GACxB;AAAA,eACOA,EAAM,aAAa;AAAA,oCACEA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,yFAGeA,EAAM,KAAK;AAAA,yFACXA,EAAM,KAAK;AAAA,4FACRA,EAAM,QAAQ;AAAA,6FACbA,EAAM,SAAS;AAAA;AAAA,WAEjG,EAAE,KAAK,EAAE,EAEhBF,EAAY,mBAAmB,YAAaC,CAAM,EAClDH,EAAS,QAAO,CACpB,CAEO,SAASK,GAAc,CAC1B,MAAMH,EAAc,SAAS,cAAc,eAAe,EAC1DA,EAAY,UAAY,EAC5B,CC1BA,MAAMI,EAAO,SAAS,cAAc,eAAe,EAC7CC,EAAQ,SAAS,cAAc,qBAAqB,EACpDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EAEvD,IAAIC,EAAa,GACbf,EAAO,EACPgB,EAAY,EAEhBL,EAAK,iBAAiB,SAAUM,CAAe,EAC/CH,EAAY,iBAAiB,QAASI,CAAc,EAEpD,eAAeD,EAAgBE,EAAO,CAClCA,EAAM,eAAc,EACpBT,IACAI,EAAY,UAAU,IAAI,QAAQ,EAClCD,EAAO,UAAU,OAAO,QAAQ,EAEhCE,EAAaH,EAAM,MAAM,OACzBZ,EAAO,EAEP,GAAI,CACA,MAAMI,EAAO,MAAMN,EAAmBiB,EAAYf,CAAI,EAClDI,EAAK,QAAU,GAAKW,IAAe,GACnCK,EAAS,MAAM,CACX,SAAU,WACV,QAAS,0EACzB,CAAa,GAEDjB,EAAaC,CAAI,EACjBY,EAAYZ,EAAK,UACbA,EAAK,KAAK,OAAS,GACnBU,EAAY,UAAU,OAAO,QAAQ,EAGhD,MAAe,CACZM,EAAS,MAAM,CACX,SAAU,WACV,QAAS,gDACrB,CAAS,CACT,QAAc,CACNP,EAAO,UAAU,IAAI,QAAQ,CAChC,CAEDF,EAAK,MAAK,CACd,CAEA,eAAeO,GAAiB,CAC5BlB,GAAQ,EACRa,EAAO,UAAU,OAAO,QAAQ,EAChCC,EAAY,UAAU,IAAI,QAAQ,EAElC,GAAI,CACA,MAAMV,EAAO,MAAMN,EAAmBiB,EAAYf,CAAI,EACtDG,EAAaC,CAAI,EAEbJ,EAAO,IAAMgB,GACbF,EAAY,UAAU,IAAI,QAAQ,EAClCM,EAAS,KAAK,CACV,SAAU,WACV,QAAS,4DACzB,CAAa,GAEDN,EAAY,UAAU,OAAO,QAAQ,EAIzC,KAAM,CAAE,OAAQO,CAAU,EAAK,SAC1B,cAAc,eAAe,EAC7B,kBAAkB,sBAAqB,EAE5C,OAAO,SAAS,CACZ,IAAKA,EAAa,EAClB,SAAU,QACtB,CAAS,CAEJ,MAAe,CACZD,EAAS,MAAM,CACX,SAAU,WACV,QAAS,oDACrB,CAAS,CACT,QAAc,CACNP,EAAO,UAAU,IAAI,QAAQ,CAChC,CACL"}